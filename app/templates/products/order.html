{% extends 'products/base.html' %}
{% load static i18n %}
{% block title %}{{ category.name }}{% endblock %}
{% block content %}
  <script>
    function calculateDistance(lat1, lon1, lat2, lon2) {
      const earthRadiusKm = 6371;

      // Convert latitude and longitude from degrees to radians
      const lat1Rad = toRadians(lat1);
      const lon1Rad = toRadians(lon1);
      const lat2Rad = toRadians(lat2);
      const lon2Rad = toRadians(lon2);

      // Calculate differences
      const latDiff = lat2Rad - lat1Rad;
      const lonDiff = lon2Rad - lon1Rad;

      // Calculate the distance using the Haversine formula
      const a = Math.sin(latDiff / 2) * Math.sin(latDiff / 2) +
        Math.cos(lat1Rad) * Math.cos(lat2Rad) *
        Math.sin(lonDiff / 2) * Math.sin(lonDiff / 2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      const distance = earthRadiusKm * c;

      return distance;
    }

    function toRadians(degrees) {
      return degrees * Math.PI / 180;
    }

    const userLatitude = 40.7128;
    const userLongitude = -74.0060;

    const outletBranches = [
      {name: "Outlet 1", latitude: 40.741939, longitude: -73.989723},
      {name: "Outlet 2", latitude: 40.730610, longitude: -73.935242},
      {name: "Outlet 3", latitude: 40.748817, longitude: -73.985428}
    ];

    let minDistance = Infinity;
    let closestOutlet = null;

    // Calculate distance for each outlet branch
    outletBranches.forEach(branch => {
      const distance = calculateDistance(userLatitude, userLongitude, branch.latitude, branch.longitude);
      if (distance < minDistance) {
        minDistance = distance;
        closestOutlet = branch;
      }
    });

    console.log("Closest outlet:", closestOutlet.name);
    console.log("Minimum distance:", minDistance.toFixed(2), "km");

  </script>
{% endblock %}
